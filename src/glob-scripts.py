from glob import glob
import os
import pandas as pd
movie_files = glob('movie-scripts/*')
plot_df = pd.read_csv('../data/lem_plot_df')


lst = []
for script in movie_files:
    title = os.path.basename(script)
    title = title.split('.')[0]
    with open(script) as f:
        text = f.read()
        text = text.strip("\n")
        lst.append(tuple((title, text)))

df = pd.DataFrame(lst)

# scores = [
#
# ]
plot_df['title'].replace(' ','-', regex=True, inplace=True)

new_df = pd.merge(df, plot_df,  how='left', left_on=[0], right_on = ['title'])
new_df.drop(['title', 'plot', 'Unnamed: 0'], axis=1, inplace=True)

# new_df['rating'][3] =
new_df['rating'][3] = 46.0
new_df['rating'][5] = 89.0
new_df['rating'][7] = 87.0
new_df['rating'][9] = 62.0
new_df['rating'][12] = 86.0
new_df['rating'][13] = 64.0
new_df['rating'][14] = 79.0
new_df['rating'][16] = 79.0
new_df['rating'][18] = 80.0
new_df['rating'][23] = 92.0
new_df['rating'][29] = 31.0
new_df['rating'][34] = 84.0
new_df['rating'][36] = 100.0
new_df['rating'][38] = 96.0
new_df['rating'][40] = 53.0
new_df['rating'][42] = 46.0
new_df['rating'][43] = 61.0
new_df['rating'][44] = 34.0
new_df['rating'][46] = 71.0
new_df['rating'][51] = 53.0
new_df['rating'][54] = 80.0
new_df['rating'][55] = 57.0
new_df['rating'][57] = 95.0
new_df['rating'][58] = 53.0
new_df['rating'][65] = 21.0
new_df['rating'][66] = 25.0
new_df['rating'][67] = 26.0
new_df['rating'][68] = 72.0
new_df['rating'][70] = 71.0
new_df['rating'][76] = 89.0
new_df['rating'][77] = 80.0
new_df['rating'][78] = 96.0
new_df['rating'][80] = 88.0
new_df['rating'][81] = 55.0
new_df['rating'][83] = 85.0
new_df['rating'][86] = 72.0
new_df['rating'][87] = 89.0
new_df['rating'][91] = 79.0
new_df['rating'][95] = 78.0
new_df['rating'][96] = 81.0
new_df['rating'][97] = 93.0
new_df['rating'][100] = 84.0
new_df['rating'][101] = 100.0
new_df['rating'][103] = 39.0
new_df['rating'][105] = 96.0
new_df['rating'][109] = 51.0
new_df['rating'][115] = 89.0
new_df['rating'][116] = 28.0
new_df['rating'][118] = 75.0
new_df['rating'][119] = 63.0
new_df['rating'][120] = 78.0
new_df['rating'][124] = 83.0
new_df['rating'][126] = 79.0
new_df['rating'][141] = 21.0
new_df['rating'][143] = 96.0
new_df['rating'][144] = 86.0
new_df['rating'][147] = 50.0
new_df['rating'][151] = 55.0
new_df['rating'][153] = 65.0
new_df['rating'][154] = 68.0
new_df['rating'][156] = 71.0
new_df['rating'][158] = 65.0
new_df['rating'][159] = 40.0
new_df['rating'][161] = 68.0
new_df['rating'][162] = 32.0
new_df['rating'][165] = 55.0
new_df['rating'][167] = 85.0
new_df['rating'][171] = 47.0
new_df['rating'][172] = 48.0
new_df['rating'][175] = 22.0
new_df['rating'][176] = 61.0
new_df['rating'][179] = 51.0
new_df['rating'][181] = 89.0
new_df['rating'][183] = 14.0
new_df['rating'][184] = 78.0
new_df['rating'][190] = 12.0
new_df['rating'][193] = 24.0
new_df['rating'][194] = 51.0
new_df['rating'][197] = 76.0
new_df['rating'][200] = 89.0
new_df['rating'][204] = 93.0
new_df['rating'][205] = 96.0
new_df['rating'][207] = 79.0
new_df['rating'][208] = 84.0
new_df['rating'][209] = 46.0
new_df['rating'][211] = 93.0
new_df['rating'][213] = 33.0
new_df['rating'][215] = 93.0
new_df['rating'][217] = 74.0
new_df['rating'][218] = 94.0
# new_df['rating'][220] = 88.0
new_df['rating'][222] = 56.0
new_df['rating'][225] = 51.0
new_df['rating'][226] = 48.0
new_df['rating'][227] = 20.0
new_df['rating'][230] = 37.0
new_df['rating'][233] = 46.0
new_df['rating'][234] = 91.0
new_df['rating'][236] = 64.0
new_df['rating'][237] = 87.0
new_df['rating'][238] = 33.0
new_df['rating'][242] = 64.0
new_df['rating'][244] = 98.0
new_df['rating'][245] = 76.0
new_df['rating'][249] = 33.0
new_df['rating'][250] = 66.0
new_df['rating'][251] = 71.0
new_df['rating'][253] = 80.0
new_df['rating'][256] = 78.0
new_df['rating'][259] = 53.0
new_df['rating'][264] = 70.0
new_df['rating'][265] = 17.0
new_df['rating'][267] = 68.0
new_df['rating'][268] = 66.0
new_df['rating'][269] = 76.0
new_df['rating'][274] = 92.0
new_df['rating'][276] = 70.0
new_df['rating'][277] = 13.0
new_df['rating'][279] = 21.0
new_df['rating'][280] = 40.0
new_df['rating'][283] = 88.0
new_df['rating'][284] = 81.0
new_df['rating'][292] = 95.0
new_df['rating'][295] = 95.0
new_df['rating'][297] = 74.0
new_df['rating'][299] = 87.0
new_df['rating'][301] = 77.0
new_df['rating'][302] = 80.0
new_df['rating'][303] = 38.0
new_df['rating'][306] = 60.0
new_df['rating'][309] = 39.0
new_df['rating'][312] = 74.0
new_df['rating'][316] = 91.0
new_df['rating'][317] = 85.0
new_df['rating'][318] = 61.0
new_df['rating'][320] = 94.0
new_df['rating'][321] = 51.0
new_df['rating'][324] = 30.0
new_df['rating'][325] = 97.0
new_df['rating'][327] = 89.0
new_df['rating'][331] = 76.0
new_df['rating'][332] = 66.0
new_df['rating'][335] = 43.0
new_df['rating'][336] = 77.0
new_df['rating'][344] = 95.0
new_df['rating'][346] = 98.0
new_df['rating'][348] = 71.0
new_df['rating'][349] = 71.0
new_df['rating'][352] = 97.0
new_df['rating'][353] = 73.0
new_df['rating'][357] = 64.0
new_df['rating'][358] = 74.0
new_df['rating'][359] = 89.0
new_df['rating'][360] = 41.0
new_df['rating'][366] = 86.0
new_df['rating'][367] = 85.0
new_df['rating'][368] = 34.0
new_df['rating'][370] = 18.0
new_df['rating'][372] = 98.0
new_df['rating'][373] = 92.0
new_df['rating'][374] = 41.0
new_df['rating'][375] = 51.0
new_df['rating'][377] = 92.0
new_df['rating'][381] = 88.0
new_df['rating'][382] = 95.0
new_df['rating'][384] = 50.0
new_df['rating'][385] = 95.0
new_df['rating'][386] = 73.0
new_df['rating'][393] = 11.0
new_df['rating'][394] = 98.0
new_df['rating'][397] = 53.0
new_df['rating'][398] = 93.0
new_df['rating'][400] = 100.0
new_df['rating'][404] = 49.0
new_df['rating'][405] = 37.0
new_df['rating'][408] = 67.0
new_df['rating'][409] = 93.0
new_df['rating'][410] = 80.0
new_df['rating'][412] = 98.0
new_df['rating'][415] = 61.0
new_df['rating'][416] = 44.0
new_df['rating'][418] = 53.0
new_df['rating'][420] = 29.0
new_df['rating'][421] = 69.0
new_df['rating'][427] = 85.0
new_df['rating'][428] = 96.0
new_df['rating'][431] = 22.0
new_df['rating'][435] = 65.0
new_df['rating'][437] = 85.0
new_df['rating'][439] = 74.0
new_df['rating'][441] = 39.0
new_df['rating'][443] = 21.0
new_df['rating'][444] = 54.0
new_df['rating'][446] = 46.0
new_df['rating'][447] = 98.0
new_df['rating'][448] = 910
new_df['rating'][449] = 97.0
new_df['rating'][452] = 90.0
new_df['rating'][458] = 54.0
new_df['rating'][460] = 49.0
new_df['rating'][461] = 61.0
new_df['rating'][462] = 30.0
new_df['rating'][463] = 67.0
new_df['rating'][471] = 33.0
new_df['rating'][479] = 94.0
new_df['rating'][482] = 76.0
new_df['rating'][484] = 73.0
new_df['rating'][485] = 67.0
new_df['rating'][486] = 63.0
new_df['rating'][488] = 66.0
new_df['rating'][489] = 25.0
new_df['rating'][490] = 58.0
new_df['rating'][500] = 98.0
new_df['rating'][503] = 95.0
new_df['rating'][504] = 40.0
new_df['rating'][506] = 70.0
new_df['rating'][508] = 88.0
new_df['rating'][510] = 29.0
new_df['rating'][511] = 37.0
new_df['rating'][515] = 79.0
new_df['rating'][517] = 94.0
new_df['rating'][518] = 28.0
new_df['rating'][521] = 23.0
new_df['rating'][524] = 93.0
new_df['rating'][526] = 70.0
new_df['rating'][527] = 10.0
new_df['rating'][529] = 97.0
new_df['rating'][532] = 86.0
new_df['rating'][534] = 81.0
new_df['rating'][535] = 44.0
new_df['rating'][536] = 70.0
new_df['rating'][537] = 57.0
new_df['rating'][538] = 82.0
new_df['rating'][544] = 85.0
new_df['rating'][545] = 28.0
new_df['rating'][546] = 95.0
new_df['rating'][547] = 32.0
new_df['rating'][549] = 62.0
new_df['rating'][551] = 34.0
new_df['rating'][553] = 94.0
new_df['rating'][557] = 90.0
new_df['rating'][558] = 60.0
# new_df['rating'][560] = .0
new_df['rating'][561] = 52.0
new_df['rating'][562] = 79.0
new_df['rating'][564] = 40.0
new_df['rating'][565] = 53.0
new_df['rating'][568] = 52.0
new_df['rating'][571] = 94.0
new_df['rating'][572] = 85.0
new_df['rating'][574] = 60.0
new_df['rating'][575] = 92.0
new_df['rating'][580] = 91.0
new_df['rating'][584] = 52.0
new_df['rating'][585] = 56.0
new_df['rating'][587] = 68.0
new_df['rating'][588] = 35.0
new_df['rating'][592] = 78.0
new_df['rating'][594] = 30.0
new_df['rating'][595] = 79.0
new_df['rating'][597] = 92.0
new_df['rating'][598] = 85.0
new_df['rating'][599] = 92.0
new_df['rating'][601] = 92.0
new_df['rating'][602] = 50.0
new_df['rating'][603] = 30.0
new_df['rating'][606] = 80.0
new_df['rating'][608] = 35.0
new_df['rating'][610] = 88.0
new_df['rating'][611] = 91.0
new_df['rating'][612] = 96.0
new_df['rating'][613] = 97.0
new_df['rating'][614] = 92.0
new_df['rating'][616] = 68.0
new_df['rating'][618] = 47.0
new_df['rating'][619] = 41.0
new_df['rating'][621] = 55.0
new_df['rating'][622] = 27.0
new_df['rating'][626] = 95.0
new_df['rating'][627] = 70.0
new_df['rating'][630] = 62.0
new_df['rating'][634] = 85.0
new_df['rating'][635] = 92.0
new_df['rating'][638] = 93.0
new_df['rating'][641] = 44.0
new_df['rating'][645] = 55.0
new_df['rating'][646] = 71.0
new_df['rating'][651] = 93.0
new_df['rating'][655] = 21.0
new_df['rating'][657] = 64.0
new_df['rating'][658] = 96.0
new_df['rating'][661] = 43.0
new_df['rating'][666] = 97.0
new_df['rating'][667] = 85.0
new_df['rating'][668] = 33.0
new_df['rating'][671] = 46.0
new_df['rating'][672] = 57.0
new_df['rating'][674] = 87.0
new_df['rating'][676] = 17.0
new_df['rating'][678] = 22.0
new_df['rating'][680] = 93.0
new_df['rating'][683] = 80.0
new_df['rating'][685] = 61.0
new_df['rating'][686] = 83.0
new_df['rating'][687] = 97.0
new_df['rating'][690] = 99.0
new_df['rating'][691] = 27.0
new_df['rating'][695] = 25.0
new_df['rating'][696] = 51.0
new_df['rating'][697] = 100.0
new_df['rating'][699] = 67.0
new_df['rating'][702] = 85.0
new_df['rating'][706] = 88.0
new_df['rating'][707] = 83.0
new_df['rating'][708] = 21.0
new_df['rating'][711] = 61.0
new_df['rating'][712] = 15.0
new_df['rating'][713] = 63.0
new_df['rating'][715] = 49.0
new_df['rating'][717] = 94.0
new_df['rating'][719] = 62.0
new_df['rating'][721] = 83.0
new_df['rating'][722] = 83.0
new_df['rating'][723] = 40.0
new_df['rating'][725] = 88.0
new_df['rating'][730] = 53.0
new_df['rating'][732] = 74.0
new_df['rating'][734] = 95.0
new_df['rating'][735] = 25.0
new_df['rating'][737] = 76.0
new_df['rating'][739] = 53.0
new_df['rating'][740] = 95.0
new_df['rating'][741] = 85.0
new_df['rating'][742] = 100.0
new_df['rating'][743] = 16.0
new_df['rating'][744] = 7.0
new_df['rating'][745] = 57.0
new_df['rating'][746] = 80.0
new_df['rating'][748] = 54.0
new_df['rating'][749] = 66.0
new_df['rating'][750] = 82.0
new_df['rating'][751] = 30.0
new_df['rating'][752] = 73.0
new_df['rating'][753] = 75.0
new_df['rating'][754] = 38.0
new_df['rating'][755] = 43.0
new_df['rating'][757] = 48.0
new_df['rating'][758] = 28.0
new_df['rating'][759] = 98.0
new_df['rating'][761] = 85.0
new_df['rating'][762] = 77.0
new_df['rating'][765] = 42.0
new_df['rating'][769] = 57.0
new_df['rating'][770] = 89.0
new_df['rating'][771] = 88.0
new_df['rating'][775] = 94.0
new_df['rating'][778] = 54.0
new_df['rating'][782] = 94.0
new_df['rating'][783] = 33.0
new_df['rating'][784] = 84.0
new_df['rating'][785] = 92.0
new_df['rating'][786] = 75.0
new_df['rating'][791] = 81.0
new_df['rating'][793] = 75.0
new_df['rating'][797] = 47.0
new_df['rating'][799] = 100.0
new_df['rating'][809] = 74.0
new_df['rating'][810] = 65.0
new_df['rating'][811] = 32.0
new_df['rating'][815] = 44.0
new_df['rating'][817] = 65.0
new_df['rating'][818] = 93.0
new_df['rating'][819] = 65.0
new_df['rating'][820] = 95.0
new_df['rating'][822] = 82.0
new_df['rating'][823] = 68.0
new_df['rating'][825] = 41.0
# new_df['rating'][826] = .97
new_df['rating'][827] = 78.0
new_df['rating'][829] = 86.0
new_df['rating'][832] = 20.0
new_df['rating'][833] = 91.0
new_df['rating'][834] = 71.0
new_df['rating'][835] = 93.0
new_df['rating'][836] = 82.0
new_df['rating'][839] = 51.0
new_df['rating'][841] = 39.0
new_df['rating'][842] = 94.0
new_df['rating'][843] = 42.0
new_df['rating'][845] = 73.0
new_df['rating'][846] = 57.0
new_df['rating'][848] = 84.0
new_df['rating'][849] = 56.0
new_df['rating'][850] = 55.0
new_df['rating'][852] = 13.0
new_df['rating'][853] = 80.0
new_df['rating'][856] = 51.0
new_df['rating'][857] = 23.0
new_df['rating'][858] = 84.0
new_df['rating'][863] = 62.0
new_df['rating'][864] = 9.0
new_df['rating'][866] = 78.0
new_df['rating'][867] = 89.0
new_df['rating'][868] = 57.0
new_df['rating'][871] = 53.0
new_df['rating'][872] = 82.0
new_df['rating'][873] = 32.0
new_df['rating'][875] = 94.0
new_df['rating'][876] = 26.0
new_df['rating'][878] = 21.0
new_df['rating'][881] = 12.0
new_df['rating'][883] = 34.0
new_df['rating'][886] = 82.0
new_df['rating'][890] = 93.0
new_df['rating'][891] = 75.0
new_df['rating'][892] = 92.0
new_df['rating'][895] = 96.0
new_df['rating'][896] = 90.0
new_df['rating'][897] = 78.0
new_df['rating'][898] = 28.0
new_df['rating'][899] = 98.0
# new_df['rating'][902] = .0
new_df['rating'][903] = 95.0
new_df['rating'][904] = 55.0
new_df['rating'][908] = 41.0
new_df['rating'][910] = 98.0
new_df['rating'][911] = 54.0
new_df['rating'][913] = 51.0
new_df['rating'][915] = 75.0
new_df['rating'][916] = 95.0
new_df['rating'][917] = 44.0
new_df['rating'][919] = 91.0
new_df['rating'][920] = 16.0
new_df['rating'][922] = 94.0
new_df['rating'][924] = 25.0
new_df['rating'][925] = 65.0
new_df['rating'][927] = 98.0
new_df['rating'][929] = 55.0
new_df['rating'][930] = 87.0
new_df['rating'][931] = 72.0
new_df['rating'][934] = 78.0
new_df['rating'][936] = 85.0
new_df['rating'][939] = 98.0
new_df['rating'][940] = 91.0
new_df['rating'][941] = 38.0
new_df['rating'][943] = 71.0
new_df['rating'][950] = 89.0
new_df['rating'][952] = 86.0
new_df['rating'][955] = 93.0
new_df['rating'][956] = 71.0
new_df['rating'][958] = 86.0
new_df['rating'][961] = 96.0
new_df['rating'][962] = 47.0
new_df['rating'][963] = 74.0
new_df['rating'][970] = 76.0
new_df['rating'][971] = 81.0
new_df['rating'][974] = 92.0
new_df['rating'][975] = 97.0
new_df['rating'][978] = 97.0
new_df['rating'][981] = 65.0
new_df['rating'][984] = 89.0
new_df['rating'][986] = 89.0
new_df['rating'][987] = 45.0
new_df['rating'][991] = 25.0
new_df['rating'][993] = 57.0
new_df['rating'][1001] = 90.0
new_df['rating'][1004] = 91.0
new_df['rating'][1005] = 42.0
new_df['rating'][1006] = 15.0
new_df['rating'][1007] = 88.0
new_df['rating'][1008] = 100.0
new_df['rating'][1011] = 90.0
new_df['rating'][1015] = 8.0
new_df['rating'][1018] = 60.0
new_df['rating'][1020] = 62.0
new_df['rating'][1021] = 74.0
new_df['rating'][1022] = 20.0
new_df['rating'][1023] = 98.0
new_df['rating'][1026] = 69.0
new_df['rating'][1027] = 84.0
new_df['rating'][1029] = 8.0
new_df['rating'][1031] = 76.0
new_df['rating'][1036] = 99.0
new_df['rating'][1037] = 94.0
new_df['rating'][1041] = 98.0
new_df['rating'][1043] = 52.0
new_df['rating'][1049] = 66.0
new_df['rating'][1053] = 60.0
new_df['rating'][1057] = 94.0
new_df['rating'][1063] = 70.0
new_df['rating'][1064] = 49.0
new_df['rating'][1067] = 74.0
new_df['rating'][1070] = 51.0
new_df['rating'][1071] = 74.0
new_df['rating'][1072] = 97.0
new_df['rating'][1073] = 90.0
new_df['rating'][1074] = 56.0
new_df['rating'][1078] = 69.0
new_df['rating'][1080] = 98.0
new_df['rating'][1081] = 19.0
new_df['rating'][1082] = 44.0
new_df['rating'][1083] = 80.0
new_df['rating'][1084] = 86.0
new_df['rating'][1086] = 91.0
new_df['rating'][1087] = 83.0
new_df['rating'][1088] = 93.0
new_df['rating'][1089] = 13.0
new_df['rating'][1090] = 47.0
new_df['rating'][1091] = 4.0
new_df['rating'][1096] = 43.0
new_df['rating'][1098] = 80.0
new_df['rating'][1100] = 71.0
new_df['rating'][1101] = 71.0
new_df['rating'][1102] = 65.0
new_df['rating'][1103] = 6.0
new_df['rating'][1104] = 60.0
new_df['rating'][1105] = 83.0
new_df['rating'][1106] = 77.0
new_df['rating'][1107] = 90.0
new_df['rating'][1108] = 94.0
new_df['rating'][1109] = 40.0
new_df['rating'][1015] = 52.0
new_df['rating'][1019] = 22.0
new_df['rating'][1025] = 83.0
new_df['rating'][1030] = 51.0
new_df['rating'][1032] = 26.0
new_df['rating'][1034] = 97.0
new_df['rating'][1036] = 58.0
new_df['rating'][1037] = 91.0
new_df['rating'][1039] = 37.0
new_df['rating'][1142] = 75.0
new_df['rating'][1144] = 78.0
new_df['rating'][1145] = 42.0

new_df = new_df.dropna()
# new_df.columns = ['title', 'script', 'rating']
new_df.to_csv('../data/scripts_df')
